<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>å…¬èªä¼šè¨ˆå£«è©¦é¨“ åå·®å€¤è¨ˆç®—ã‚¢ãƒ—ãƒª</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&family=Noto+Serif+JP:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <style>
      body {
        font-family:
          'Crimson Text', 'Noto Serif JP', 'Times New Roman', 'Yu Mincho',
          'YuMincho', 'Hiragino Mincho ProN', serif;
        background: linear-gradient(
          135deg,
          #e3ecf7 0%,
          #f7fafd 100%
        ); /* æ·¡ã„ãƒ–ãƒ«ãƒ¼ã‚°ãƒ¬ãƒ¼ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
        margin: 0;
        padding: 0;
        font-weight: 400;
        letter-spacing: 0.01em;
      }
      .container {
        max-width: 420px;
        margin: 2rem auto;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.07);
        padding: 1.5rem;
      }
      h1 {
        font-size: 1.3rem;
        text-align: center;
        margin-bottom: 1.2rem;
        font-weight: 700;
        letter-spacing: 0.02em;
      }
      label {
        display: block;
        margin-bottom: 0.2rem;
        font-size: 1rem;
      }
      input[type='number'],
      select {
        width: 100%;
        padding: 0.6rem;
        margin-bottom: 1rem;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 1rem;
        font-family: inherit;
        box-sizing: border-box;
      }
      button {
        width: 100%;
        padding: 0.9rem 1.5rem;
        background: #2c3e50;
        color: #fff;
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        font-family: inherit;
        cursor: pointer;
        margin-bottom: 1rem;
        letter-spacing: 0.005em;
        box-shadow: 0 2px 6px rgba(44, 62, 80, 0.2);
        transition: all 0.2s ease;
      }
      button:hover {
        background: #34495e;
        box-shadow: 0 3px 8px rgba(44, 62, 80, 0.3);
      }
      button:active {
        background: #2c3e50;
        box-shadow: 0 1px 3px rgba(44, 62, 80, 0.3);
        transform: translateY(1px);
      }
      button:focus {
        outline: none;
        box-shadow:
          0 2px 6px rgba(44, 62, 80, 0.2),
          0 0 0 3px rgba(52, 152, 219, 0.3);
      }

      #tweetBtn {
        display: none;
      }

      .result {
        text-align: center;
        margin: 1.2rem 0 0.5rem 0;
        font-size: 1.2rem;
        font-weight: bold;
        color: #333;
        display: none; /* åˆæœŸçŠ¶æ…‹ã§ã¯éè¡¨ç¤º */
      }

      #radarChart {
        display: none; /* åˆæœŸçŠ¶æ…‹ã§ã¯éè¡¨ç¤º */
      }
      .card {
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1.2rem;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
      }
      .card-title {
        font-weight: 600;
        font-size: 1.08rem;
        margin-bottom: 0.7rem;
        color: #1a237e;
        display: flex;
        align-items: center;
        justify-content: space-between;
        letter-spacing: 0.01em;
      }
      .menjo-label {
        font-weight: normal;
        font-size: 0.98rem;
        margin-left: auto;
        display: flex;
        align-items: center;
        gap: 0.2em;
      }
      .menjo-message {
        color: #2e7d32;
        font-size: 1.3rem;
        margin-bottom: 0.7rem;
        text-align: left;
        font-weight: bold;
        text-align: center;
      }
      .card.kanri {
        background: #fff7e0;
        /* ã‚ªãƒ¬ãƒ³ã‚¸å¯„ã‚Šã®é»„è‰² */
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 1px solid orange;
        /* æ˜ã‚‹ã„ã‚ªãƒ¬ãƒ³ã‚¸ã®æ ç·š */
        box-shadow: inset 8px 0 0 orange;
      }
      .card.kansa {
        background: #e0f4ff;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 1px solid #0288d1;

        box-shadow: inset 8px 0 0 #0288d1;
        /* æ°´è‰² */
      }
      .card.hou {
        background: #fffde0;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 1px solid #bfa800;
        box-shadow: inset 8px 0 0 #bfa800;
        /* é»„è‰² */
      }
      .card.sozei {
        background: #f3e0ff;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 1px solid #8e24aa;
        box-shadow: inset 8px 0 0 #8e24aa;
        /* ç´«è‰² */
      }
      .card.sentaku {
        background: #e0ffe0;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 1px solid #388e3c;
        box-shadow: inset 8px 0 0 #388e3c;
        /* ç·‘è‰² */
      }
      .card.zaimu {
        background: #ffe0e0;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 1px solid #d32f2f;
        box-shadow: inset 8px 0 0 #d32f2f;
        /* èµ¤è‰² */
      }
      @media (max-width: 600px) {
        .container {
          margin: 0.5rem;
          padding: 1rem;
        }
        h1 {
          font-size: 1.1rem;
        }
      }

      footer {
        text-align: center;
        padding: 1rem;
        margin-top: 2rem;
        font-size: 0.85rem;
        color: #666;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      footer .logo {
        width: 24px;
        height: 24px;
        flex-shrink: 0;
      }

      @media (max-width: 600px) {
        footer {
          margin-top: 1rem;
          padding: 0.8rem;
          font-size: 0.8rem;
        }
        
        footer .logo {
          width: 20px;
          height: 20px;
        }
      }

      .screenshot-message {
        text-align: center;
        margin-top: 1rem;
        padding: 0.8rem;
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        font-size: 0.9rem;
        color: #495057;
        display: none;
      }

      @media (max-width: 600px) {
        .screenshot-message {
          font-size: 0.85rem;
          padding: 0.7rem;
        }
      }
    </style>
    <!-- Google tag (gtag.js) -->
    <script
      async
      defer
      src="https://www.googletagmanager.com/gtag/js?id=G-97XT4DG7G4"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'G-97XT4DG7G4');
    </script>
  </head>
  <body>
    <div class="container">
      <h1>è«–æ–‡å¼è©¦é¨“ åå·®å€¤è¨ˆç®—</h1>
      <p style="text-align: center; font-size: 0.9rem">
        å„ç§‘ç›®ã®åå·®å€¤ã‚’å…¥åŠ›ã—ã¦è¨ˆç®—ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã ã‘ã€‚<br />
        ç·åˆåå·®å€¤ã¨ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’è‡ªå‹•ã§è¡¨ç¤ºã—ã¾ã™ã€‚
      </p>
      <p style="text-align: center; font-size: 0.9rem">
        â€»åå·®å€¤ã¯åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
      </p>
      <form id="hensachiForm" autocomplete="off">
        <div class="card zaimu">
          <div class="card-title">
            è²¡å‹™ä¼šè¨ˆè«–
            <label class="menjo-label"
              ><input type="checkbox" id="menjo-zaimu" />å…é™¤</label
            >
          </div>
          <div
            class="menjo-message"
            id="menjo-msg-zaimu"
            style="display: none"
          ></div>
          <input
            type="number"
            id="zaimu"
            name="zaimu"
            min="0"
            max="100"
            inputmode="decimal"
            placeholder="åå·®å€¤ã‚’å…¥åŠ›"
          />
        </div>
        <div class="card kanri">
          <div class="card-title">
            ç®¡ç†ä¼šè¨ˆè«–
            <label class="menjo-label"
              ><input type="checkbox" id="menjo-kanri" />å…é™¤</label
            >
          </div>
          <div
            class="menjo-message"
            id="menjo-msg-kanri"
            style="display: none"
          ></div>
          <input
            type="number"
            id="kanri"
            name="kanri"
            min="0"
            max="100"
            inputmode="decimal"
            placeholder="åå·®å€¤ã‚’å…¥åŠ›"
          />
        </div>
        <div class="card kansa">
          <div class="card-title">
            ç›£æŸ»è«–
            <label class="menjo-label"
              ><input type="checkbox" id="menjo-kansa" />å…é™¤</label
            >
          </div>
          <div
            class="menjo-message"
            id="menjo-msg-kansa"
            style="display: none"
          ></div>
          <input
            type="number"
            id="kansa"
            name="kansa"
            min="0"
            max="100"
            inputmode="decimal"
            placeholder="åå·®å€¤ã‚’å…¥åŠ›"
          />
        </div>
        <div class="card hou">
          <div class="card-title">
            ä¼æ¥­æ³•
            <label class="menjo-label"
              ><input type="checkbox" id="menjo-hou" />å…é™¤</label
            >
          </div>
          <div
            class="menjo-message"
            id="menjo-msg-hou"
            style="display: none"
          ></div>
          <input
            type="number"
            id="hou"
            name="hou"
            min="0"
            max="100"
            inputmode="decimal"
            placeholder="åå·®å€¤ã‚’å…¥åŠ›"
          />
        </div>
        <div class="card sozei">
          <div class="card-title">
            ç§Ÿç¨æ³•
            <label class="menjo-label"
              ><input type="checkbox" id="menjo-sozei" />å…é™¤</label
            >
          </div>
          <div
            class="menjo-message"
            id="menjo-msg-sozei"
            style="display: none"
          ></div>
          <input
            type="number"
            id="sozei"
            name="sozei"
            min="0"
            max="100"
            inputmode="decimal"
            placeholder="åå·®å€¤ã‚’å…¥åŠ›"
          />
        </div>
        <div class="card sentaku">
          <div class="card-title">
            é¸æŠç§‘ç›®ï¼ˆçµŒå–¶å­¦ï¼‰
            <label class="menjo-label"
              ><input type="checkbox" id="menjo-sentaku" />å…é™¤</label
            >
          </div>
          <div
            class="menjo-message"
            id="menjo-msg-sentaku"
            style="display: none"
          ></div>
          <input
            type="number"
            id="sentaku"
            name="sentaku"
            min="0"
            max="100"
            inputmode="decimal"
            placeholder="åå·®å€¤ã‚’å…¥åŠ›"
          />
        </div>
        <button type="button" id="calcBtn">è¨ˆç®—ã™ã‚‹</button>
      </form>
      <div class="result" id="result"></div>
      <canvas id="radarChart" style="max-width: 100%"></canvas>
      <button type="button" id="tweetBtn">çµæœã‚’Xã‚’ãƒã‚¹ãƒˆ</button>
      <div class="screenshot-message" id="screenshotMessage">
        ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚’ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦æŠ•ç¨¿ã—ã‚ˆã†ï¼
      </div>

    </div>
    
    <footer>
      <p>Produced by Redraw</p>
      <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="blueGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#1e5ba8;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />
          </linearGradient>
        </defs>
        <path d="M10 10 L60 10 L50 50 L0 50 Z" fill="url(#blueGradient)" />
        <path d="M40 50 L90 50 L80 90 L30 90 Z" fill="url(#blueGradient)" />
      </svg>
    </footer>
    <script type="module">
      import { calcHensachi } from './hensachi-calc.js';
      let chart = null;

      function getNum(id) {
        const v = document.getElementById(id).value;
        return v === '' || isNaN(Number(v)) ? null : Number(v);
      }

      // å…¨è§’æ•°å­—ãƒã‚§ãƒƒã‚¯ç”¨é–¢æ•°
      function containsZenkakuNumber(str) {
        return /[ï¼-ï¼™]/.test(str);
      }

      document.getElementById('calcBtn').addEventListener('click', function () {
        // å…¥åŠ›æ¬„ã‚’ã™ã¹ã¦å–å¾—
        const inputIds = ['zaimu', 'kanri', 'kansa', 'hou', 'sozei', 'sentaku'];
        for (const id of inputIds) {
          const val = document.getElementById(id).value;
          if (containsZenkakuNumber(val)) {
            document.getElementById('result').textContent =
              'åå·®å€¤ã¯åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
            document.getElementById('result').style.display = 'block';
            if (chart) chart.destroy();
            document.getElementById('radarChart').style.display = 'none';
            document.getElementById('tweetBtn').style.display = 'none';
            document.getElementById('screenshotMessage').style.display = 'none';
            return;
          }
        }

        // å…¥åŠ›å€¤ãŒæœªå…¥åŠ›ã®ç§‘ç›®ãŒã‚ã‚Œã°ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        let emptyInput = false;
        for (const id of inputIds) {
          const menjoId = id.replace(
            /^(zaimu|kanri|kansa|hou|sozei|sentaku)$/,
            'menjo-$1'
          );
          const isMenjo = document.getElementById(menjoId).checked;
          const val = document.getElementById(id).value;
          if (!isMenjo && (val === '' || isNaN(Number(val)))) {
            emptyInput = true;
            break;
          }
        }
        if (emptyInput) {
          document.getElementById('result').textContent =
            'åå·®å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
          document.getElementById('result').style.display = 'block';
          if (chart) chart.destroy();
          document.getElementById('radarChart').style.display = 'none';
          document.getElementById('tweetBtn').style.display = 'none';
          document.getElementById('screenshotMessage').style.display = 'none';
          return;
        }
        for (const id of inputIds) {
          const val = document.getElementById(id).value;
          if (containsZenkakuNumber(val)) {
            document.getElementById('result').textContent =
              'åå·®å€¤ã¯åŠè§’æ•°å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
            document.getElementById('result').style.display = 'block';
            if (chart) chart.destroy();
            document.getElementById('radarChart').style.display = 'none';
            document.getElementById('tweetBtn').style.display = 'none';
            document.getElementById('screenshotMessage').style.display = 'none';
            return;
          }
        }

        // å…é™¤åˆ¤å®š
        const menjo = {
          zaimu: document.getElementById('menjo-zaimu').checked,
          kanri: document.getElementById('menjo-kanri').checked,
          kansa: document.getElementById('menjo-kansa').checked,
          hou: document.getElementById('menjo-hou').checked,
          sozei: document.getElementById('menjo-sozei').checked,
          sentaku: document.getElementById('menjo-sentaku').checked,
        };

        // å„ç§‘ç›®ã®åå·®å€¤è¨ˆç®—
        let hensachi = {};
        if (!menjo.kanri) {
          const v = getNum('kanri');
          hensachi['ç®¡ç†ä¼šè¨ˆè«–'] = v !== null ? v : null;
        } else {
          hensachi['ç®¡ç†ä¼šè¨ˆè«–'] = null;
        }
        if (!menjo.zaimu) {
          const v = getNum('zaimu');
          hensachi['è²¡å‹™ä¼šè¨ˆè«–'] = v !== null ? v : null;
        } else {
          hensachi['è²¡å‹™ä¼šè¨ˆè«–'] = null;
        }
        if (!menjo.kansa) {
          const v = getNum('kansa');
          hensachi['ç›£æŸ»è«–'] = v !== null ? v : null;
        } else {
          hensachi['ç›£æŸ»è«–'] = null;
        }
        if (!menjo.hou) {
          const v = getNum('hou');
          hensachi['ä¼æ¥­æ³•'] = v !== null ? v : null;
        } else {
          hensachi['ä¼æ¥­æ³•'] = null;
        }
        if (!menjo.sozei) {
          const v = getNum('sozei');
          hensachi['ç§Ÿç¨æ³•'] = v !== null ? v : null;
        } else {
          hensachi['ç§Ÿç¨æ³•'] = null;
        }
        if (!menjo.sentaku) {
          const v = getNum('sentaku');
          hensachi['çµŒå–¶å­¦'] = v !== null ? v : null;
        } else {
          hensachi['çµŒå–¶å­¦'] = null;
        }

        // ç·åˆåå·®å€¤è¨ˆç®—
        let kanri = hensachi['ç®¡ç†ä¼šè¨ˆè«–'];
        let zaimu = hensachi['è²¡å‹™ä¼šè¨ˆè«–'];
        let kansa = hensachi['ç›£æŸ»è«–'];
        let hou = hensachi['ä¼æ¥­æ³•'];
        let sozei = hensachi['ç§Ÿç¨æ³•'];
        let sentaku = hensachi['çµŒå–¶å­¦'];
        let sogo = null;
        let sogo_n = 0;
        let sogo_sum = 0;
        if (kanri !== null) {
          sogo_sum += kanri;
          sogo_n += 1;
        }
        if (zaimu !== null) {
          sogo_sum += zaimu * 2;
          sogo_n += 2;
        }
        if (kansa !== null) {
          sogo_sum += kansa;
          sogo_n += 1;
        }
        if (hou !== null) {
          sogo_sum += hou;
          sogo_n += 1;
        }
        if (sozei !== null) {
          sogo_sum += sozei;
          sogo_n += 1;
        }
        if (sentaku !== null) {
          sogo_sum += sentaku;
          sogo_n += 1;
        }
        if (sogo_n > 0) {
          sogo = sogo_sum / sogo_n;
        }

        // è¡¨ç¤ºç”¨ãƒ‡ãƒ¼ã‚¿ä½œæˆ
        const labels = [];
        const values = [];
        for (const key of [
          'ç®¡ç†ä¼šè¨ˆè«–',
          'è²¡å‹™ä¼šè¨ˆè«–',
          'ç›£æŸ»è«–',
          'ä¼æ¥­æ³•',
          'ç§Ÿç¨æ³•',
          'çµŒå–¶å­¦',
        ]) {
          if (hensachi[key] !== null) {
            labels.push(key);
            values.push(Number(hensachi[key].toFixed(2)));
          }
        }
        let sogoLabel = '';
        let tweetText = '';
        let isAshikiri = values.some((v) => v < 40);
        const totalHensachi = Number(sogo.toFixed(2));
        sogoLabel = `ç·åˆåå·®å€¤ï¼š${totalHensachi}`;
        if (isAshikiri) {
          tweetText = `ç·åˆåå·®å€¤ï¼š${totalHensachi}ï¼æ®‹å¿µãªãŒã‚‰ã€è¶³åˆ‡ã‚Šã§ã™...â˜ ï¸ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆ`;
        } else if (sogo !== null) {
          if (totalHensachi >= 65) {
            tweetText = `ç·åˆåå·®å€¤${totalHensachi}ï¼ï¼Ÿã‚„ã‚‹ã‚„ã‚“ï¼å¤©æ‰çˆ†èª•ï¼ï¼ŸğŸ¤¯ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
          } else if (totalHensachi >= 60) {
            tweetText = `ç·åˆåå·®å€¤${totalHensachi}ï¼ã„ã„ã­ï¼ã“ã®ã¾ã¾çªã£èµ°ã‚Œï½ğŸ’¨ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
          } else if (totalHensachi >= 55) {
            tweetText = `ç·åˆåå·®å€¤${totalHensachi}ã€ã‚¸ãƒ¯ã‚¸ãƒ¯ãã¦ã‚‹ã€ãã®èª¿å­ğŸ”¥ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
          } else if (totalHensachi >= 52) {
            tweetText = `ç·åˆåå·®å€¤${totalHensachi}ï¼ã‚‚ã†ã²ã¨ä¼¸ã³ï¼æ¬¡ã®è‡ªåˆ†ã«æœŸå¾…ğŸ˜ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
          } else if (totalHensachi >= 50) {
            tweetText = `ç·åˆåå·®å€¤${totalHensachi}ã€ãŠã—ã„ï¼ã‚ã¨ã¡ã‚‡ã£ã¨ã§ã‚¾ãƒ¼ãƒ³çªå…¥ğŸš€ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
          } else {
            tweetText = `ç·åˆåå·®å€¤${totalHensachi}ã€‚ã¾ã ã¾ã ã“ã“ã‹ã‚‰ï¼ãƒ¬ãƒ™ãƒç›®æŒ‡ã—ã¦ãƒªãƒ™ãƒ³ã‚¸ğŸ”¥ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
          }
        }

        // çµæœè¡¨ç¤º
        document.getElementById('result').textContent = sogoLabel;
        document.getElementById('result').style.display = 'block';

        // ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆæç”»
        const ctx = document.getElementById('radarChart').getContext('2d');
        document.getElementById('radarChart').style.display = 'block';
        if (chart) chart.destroy();
        // ã‚«ãƒ¼ãƒ‰è‰²ã¨åŒã˜è‰²ã‚’ãƒ©ãƒ™ãƒ«ã«é©ç”¨
        const labelColors = {
          ç®¡ç†ä¼šè¨ˆè«–: '#ff9800', // æ˜ã‚‹ã„ã‚ªãƒ¬ãƒ³ã‚¸
          è²¡å‹™ä¼šè¨ˆè«–: '#d32f2f', // æ¿ƒã„èµ¤
          ç›£æŸ»è«–: '#0288d1', // æ¿ƒã„æ°´è‰²
          ä¼æ¥­æ³•: '#bfa800', // æ¿ƒã„é»„è‰²
          ç§Ÿç¨æ³•: '#8e24aa', // æ¿ƒã„ç´«
          çµŒå–¶å­¦: '#388e3c', // æ¿ƒã„ç·‘
        };
        chart = new Chart(ctx, {
          type: 'radar',
          data: {
            labels: labels,
            datasets: [
              {
                label: 'åå·®å€¤',
                data: values,
                backgroundColor: 'rgba(0,123,255,0.2)',
                borderColor: 'rgba(0,123,255,1)',
                pointBackgroundColor: 'rgba(0,123,255,1)',
                pointRadius: 0,
                borderWidth: 2,
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
            },
            scales: {
              r: {
                min: 20,
                max: 70,
                ticks: {
                  stepSize: 10,
                  color: '#666',
                  font: {
                    size: 12,
                    family: "'Crimson Text', 'Noto Serif JP', serif",
                  },
                },
                pointLabels: {
                  font: {
                    size: 13,
                    family: "'Crimson Text', 'Noto Serif JP', serif",
                  },
                  color: function (context) {
                    const idx = context.index;
                    const label = context.chart.data.labels[idx];
                    return labelColors[label] || '#222';
                  },
                },
              },
            },
          },
          plugins: [
            {
              id: 'valueDisplay',
              afterDatasetsDraw: function (chart) {
                const ctx = chart.ctx;
                const data = chart.data.datasets[0].data;
                const labels = chart.data.labels;

                ctx.save();
                ctx.font = "bold 14px 'Crimson Text', 'Noto Serif JP', serif";
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                data.forEach((value, index) => {
                  const meta = chart.getDatasetMeta(0);
                  const point = meta.data[index];

                  if (point && value !== null && value !== undefined) {
                    // ãƒã‚¤ãƒ³ãƒˆã®åº§æ¨™ã‚’å–å¾—
                    const x = point.x;
                    const y = point.y;

                    // ä¸­å¿ƒã‹ã‚‰ã®è§’åº¦ã‚’è¨ˆç®—
                    const centerX =
                      chart.chartArea.left +
                      (chart.chartArea.right - chart.chartArea.left) / 2;
                    const centerY =
                      chart.chartArea.top +
                      (chart.chartArea.bottom - chart.chartArea.top) / 2;

                    const angle = Math.atan2(y - centerY, x - centerX);

                    // åå·®å€¤ã‚’è¡¨ç¤ºã™ã‚‹ä½ç½®ã‚’èª¿æ•´ï¼ˆãƒã‚¤ãƒ³ãƒˆã‹ã‚‰å°‘ã—å¤–å´ï¼‰
                    const offsetDistance = 20;
                    const textX = x + Math.cos(angle) * offsetDistance;
                    const textY = y + Math.sin(angle) * offsetDistance;

                    // èƒŒæ™¯ã®å††ã‚’æç”»
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                    ctx.beginPath();
                    ctx.arc(textX, textY, 12, 0, 2 * Math.PI);
                    ctx.fill();

                    // æ ç·šã‚’æç”»ï¼ˆç§‘ç›®åã®è‰²ã‚’ä½¿ç”¨ï¼‰
                    const label = labels[index];
                    ctx.strokeStyle =
                      labelColors[label] || 'rgba(0,123,255,0.8)';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(textX, textY, 15, 0, 2 * Math.PI);
                    ctx.stroke();

                    // åå·®å€¤ã®æ•°å€¤ã‚’æç”»
                    ctx.fillStyle = '#333';
                    ctx.fillText(value.toString(), textX, textY);
                  }
                });

                ctx.restore();
              },
            },
          ],
        });
        // ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³è¡¨ç¤º
        document.getElementById('tweetBtn').style.display = 'block';
        document.getElementById('screenshotMessage').style.display = 'block';
      });

      // å…é™¤ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®åˆ¶å¾¡
      const menjoList = [
        { box: 'menjo-zaimu', msg: 'menjo-msg-zaimu', inputs: ['zaimu'] },
        { box: 'menjo-kanri', msg: 'menjo-msg-kanri', inputs: ['kanri'] },
        { box: 'menjo-kansa', msg: 'menjo-msg-kansa', inputs: ['kansa'] },
        { box: 'menjo-hou', msg: 'menjo-msg-hou', inputs: ['hou'] },
        { box: 'menjo-sozei', msg: 'menjo-msg-sozei', inputs: ['sozei'] },
        { box: 'menjo-sentaku', msg: 'menjo-msg-sentaku', inputs: ['sentaku'] },
      ];
      menjoList.forEach(({ box, msg, inputs }) => {
        const cb = document.getElementById(box);
        const msgDiv = document.getElementById(msg);
        cb.addEventListener('change', function () {
          if (cb.checked) {
            msgDiv.style.display = '';
            inputs.forEach((id) => {
              document.getElementById(id).disabled = true;
              document.getElementById(id).value = '';
            });
          } else {
            msgDiv.style.display = 'none';
            inputs.forEach((id) => {
              document.getElementById(id).disabled = false;
            });
          }
        });
      });

      document
        .getElementById('tweetBtn')
        .addEventListener('click', function () {
          const resultText = document
            .getElementById('result')
            .textContent.trim();
          if (!resultText) {
            alert('å…ˆã«è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚');
            return;
          }
          // ç·åˆåå·®å€¤ã«å¿œã˜ãŸtweetTextã‚’å†ç”Ÿæˆ
          let tweetText = '';
          const sogoText = document
            .getElementById('result')
            .textContent.match(/ç·åˆåå·®å€¤ï¼š([0-9.]+)/);
          let totalHensachi = sogoText ? Number(sogoText[1]) : null;
          // è¶³åˆ‡ã‚Šåˆ¤å®š
          const resultDiv = document.getElementById('result');
            // å„ç§‘ç›®ã®åå·®å€¤ã‚’å–å¾—ã—ã¦ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
            const subjects = ['è²¡å‹™', 'ç®¡ç†', 'ç›£æŸ»', 'ä¼æ¥­', 'ç§Ÿç¨', 'çµŒå–¶'];
            const inputMap = {
            'è²¡å‹™': 'zaimu',
            'ç®¡ç†': 'kanri', 
            'ç›£æŸ»': 'kansa',
            'ä¼æ¥­': 'hou',
            'ç§Ÿç¨': 'sozei',
            'çµŒå–¶': 'sentaku'
            };
            
            let subjectLines = '';
            subjects.forEach(subject => {
            const inputId = inputMap[subject];
            const menjoId = `menjo-${inputId}`;
            const isMenjo = document.getElementById(menjoId).checked;
            
            if (isMenjo) {
              subjectLines += `${subject}ï¼šå…é™¤\n`;
            } else {
              const value = document.getElementById(inputId).value;
              subjectLines += `${subject}ï¼š${value || ''}\n`;
            }
            });

            if (resultDiv.innerHTML.includes('è¶³åˆ‡ã‚Šã§ã™')) {
            tweetText = `${subjectLines}\nç·åˆåå·®å€¤ï¼š${totalHensachi}ã€æ®‹å¿µãªãŒã‚‰ã€è¶³åˆ‡ã‚Šã§ã™...â˜ ï¸ #ä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
            } else if (totalHensachi !== null) {
            let sogoMessage = '';
            if (totalHensachi >= 65) {
              sogoMessage = `ç·åˆåå·®å€¤${totalHensachi}ï¼ï¼Ÿã‚„ã‚‹ã‚„ã‚“ï¼å¤©æ‰çˆ†èª•ï¼ï¼ŸğŸ¤¯`;
            } else if (totalHensachi >= 60) {
              sogoMessage = `ç·åˆåå·®å€¤${totalHensachi}ï¼ã„ã„ã­ï¼ã“ã®ã¾ã¾çªã£èµ°ã‚Œï½ğŸ’¨`;
            } else if (totalHensachi >= 55) {
              sogoMessage = `ç·åˆåå·®å€¤${totalHensachi}ã€ã‚¸ãƒ¯ã‚¸ãƒ¯ãã¦ã‚‹ã€ãã®èª¿å­ğŸ”¥`;
            } else if (totalHensachi >= 52) {
              sogoMessage = `ç·åˆåå·®å€¤${totalHensachi}ï¼ã‚‚ã†ã²ã¨ä¼¸ã³ï¼æ¬¡ã®è‡ªåˆ†ã«æœŸå¾…ğŸ˜`;
            } else if (totalHensachi >= 50) {
              sogoMessage = `ç·åˆåå·®å€¤${totalHensachi}ã€ãŠã—ã„ï¼ã‚ã¨ã¡ã‚‡ã£ã¨ã§ã‚¾ãƒ¼ãƒ³çªå…¥ğŸš€`;
            } else {
              sogoMessage = `ç·åˆåå·®å€¤${totalHensachi}ã€‚ã¾ã ã¾ã ã“ã“ã‹ã‚‰ï¼ãƒ¬ãƒ™ãƒç›®æŒ‡ã—ã¦ãƒªãƒ™ãƒ³ã‚¸ğŸ”¥`;
            }
            tweetText = `${subjectLines}\n${sogoMessage}\n#å…¬èªä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
            } else {
            tweetText = `${subjectLines}\n${resultText}\n#å…¬èªä¼šè¨ˆå£« #åå·®å€¤è¨ˆç®—`;
            }
          // Xã‚¢ãƒ—ãƒªå„ªå…ˆã§é–‹ãintentã‚¹ã‚­ãƒ¼ãƒ 
          const tweet = encodeURIComponent(tweetText + '\n' + location.href);
          const xIntentUrl = `twitter://post?message=${tweet}`;
          setTimeout(() => {
            window.location.href = xIntentUrl;
            setTimeout(() => {
              window.open(
                `https://twitter.com/intent/tweet?text=${tweet}`,
                '_blank'
              );
            }, 800);
          }, 100);
        });
    </script>
  </body>
</html>
